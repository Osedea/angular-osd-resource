"use strict";!function(){angular.module("osdResource",["ngLodash"])}(),function(){var n=angular.module("osdResource");n.config(["$provide",function(e){n.register={factory:e.factory,decorator:e.decorator}}]),n.provider("ResourceConfig",function(){var n=this,e=[],t={decorators:[],methods:{}};return n.add=function(o,r,a){return a=a||{},a.name=o,a.route=r,a.decorators=a.decorators||[],a.methods=a.methods||{},a.relations=a.relations||[],a.decorators=a.decorators.concat(t.decorators),angular.extend(a.methods,t.methods),e.push(a),n},n.global=function(e){return t=e,n},n.$get=function(){return e},n})}(),function(){function n(n){return function(e,t){var o=this;o.config=n;var r={query:{method:"GET",isArray:!1},update:{method:"PUT"}};return t.assign(r,n.methods),t.forEach(o.config.relations,function(n){r[n]={method:"GET",isArray:!0,url:o.config.route+"/"+n}}),o.resource=e(n.route,{id:"@id"},r),t.forEach(Object.keys(n.methods),function(n){o[n]=function(e){return o.resource[n](e).$promise}}),t.forEach(o.config.relations,function(n){o[n]=function(e){return o.resource[n](e).$promise}}),o.save=function(n,e,t){return o.resource.save({},n,e,t).$promise},o.update=function(n,e,t){return o.resource.update({},n,e,t).$promise},o.get=function(n,e,t){return o.resource.get(n,e,t).$promise},o.query=function(n,e,t){return o.resource.query(n,e,t).$promise},o["delete"]=function(n,e,t){return o.resource["delete"]({id:n},e,t).$promise},o}}var e=angular.module("osdResource");e.run(["ResourceConfig","lodash",function(t,o){o.forEach(t,function(t){e.register.factory(t.name,["$resource","lodash",n(t)])})}])}(),function(){function n(n,e){function t(n){var t=[];return e.forIn(n,function(n,e){t.push(e+":"+n)}),t.join("&")}function o(n){for(var e=0,t=n.length,o=0;t>o;o++)e=31*e+n.charCodeAt(o);return e}function r(t){return i.caches[n.config.name]={},e.forEach(s,function(e){i.caches[n.config.name][e]={},i.caches[n.config.name][e][t]={cached:!1,params:null,data:null}}),i.caches[n.config.name]}function a(e,a){var c=i.caches[n.config.name],u=o(t(a));if(c&&c[e]&&c[e][u]||(c=r(u)),!g&&c[e][u].cached)return c[e][u].data;c[e][u].cached=!0,c[e][u].params=a;var s=n[e](a).then(function(n){return n});return c[e][u].data=s,g=!1,s}function c(t,o){var a=i.caches[n.config.name];return a||(a=r()),e.forEach(a.get,function(n){n.cached=!1}),e.forEach(a.query,function(n){n.cached=!1}),n[t](o)}var u={},i={caches:{}},s=["get","query"],f=["save","update","delete"],g=!1;return e.extend(u,n),s=s.concat(n.config.relations),u.setForced=function(){return g=!0,u},e.forEach(s,function(n){u[n]=function(e){return a(n,e)}}),e.forEach(f,function(n){u[n]=function(e){return c(n,e)}}),u}var e=angular.module("osdResource");n.$inject=["$delegate","lodash"],e.run(["ResourceConfig","lodash",function(t,o){o.forEach(t,function(t){o.forEach(t.decorators,function(o){"cache"==o&&e.register.decorator(t.name,n)})})}])}(),function(){function n(n,e){var t={},o=["page","perPage"];return t.paginationStates||(t.paginationStates={}),e.assign(t,n),t.paginationStates[n.config.name]={page:1,perPage:null,totalCount:0,totalPage:0},t.query=function(r){r=r||{};var a=t.paginationStates[n.config.name];return e.assign(r,e.pick(a,o)),n.query(r,function(n,e){a.totalCount=e("x-total-count"),a.totalPages=e("x-total-pages")})},t.prevPage=function(e){return t.paginationStates[n.config.name].page--,t.query(e)},t.nextPage=function(e){return t.paginationStates[n.config.name].page++,t.query(e)},t.perPage=function(e){return t.paginationStates[n.config.name].perPage=e,t},t.page=function(e){return t.paginationStates[n.config.name].page=e,t},t.getTotalPage=function(){return t.paginationStates[n.config.name].totalPage},t.getTotalCount=function(){return t.paginationStates[n.config.name].totalCount},t.hasMore=function(){return t.paginationStates[n.config.name].totalPage>t.paginationStates[n.config.name].page},t}var e=angular.module("osdResource");n.$inject=["$delegate","lodash"],e.run(["ResourceConfig","lodash",function(t,o){o.forEach(t,function(t){o.forEach(t.decorators,function(o){"paginate"==o&&e.register.decorator(t.name,n)})})}])}();